<%= render 'shared/header'%>

<div class="d-flex">
  <div class="border">
    <div style="width: 230px;">
      <div class="text-center">
        <div class=" d-flex align-items-center p-2" style="height: 70px;">
          <%= "#{current_user.nickname}さんのチャット"%>
        </div>
        <hr class="featurette-divider">
      </div>
      <div class="rooms">
        <div class="p-3">
          <%= @post.title %>
          
        </div>
        <hr class="featurette-divider">
      </div>
    </div>
  </div>

  <div style="width: 100%;">

    <div class=" d-flex align-items-center p-2" style="height: 70px;">
      参加者一覧:
      <% @users.each do |user| %>
        <%= link_to "#{user.user.nickname},", user_path(user.user.id), class:"ml-3" %> 
      <% end %>
    </div>
    <hr class="featurette-divider">

  <div class="overflow-scroll" style="height: calc(100% - 200px)">
      <% @messages.each do |message| %>
        <% if message.user == current_user %>
          <div class="border mb-3 ml-3 mr-3 p-2 text-right">
            <div class="mb-2">
              <%= message.created_at %>
            </div>
            <div class="">
              <%= message.text %>
              <%= image_tag message.image.variant(resize: '500x500'), class: 'message-image' if message.image.attached? %>
            </div>
          </div>
        <% else %>
          <div class="border mb-3 ml-3 mr-3 p-2">
            <div class="mb-2">
              <%= link_to "ユーザー：#{message.user.nickname}さん", user_path(message.user.id)%>
              <%= message.created_at %>
            </div>
            <div class="">
              <%= message.text %>
              <%= image_tag message.image.variant(resize: '500x500'), class: 'message-image' if message.image.attached? %>
            </div>
          </div>
        <% end %>
      <% end %>
  </div>
  
  <hr class="featurette-divider">
  <div class="align-items-center d-flex justify-content-end mb-4">
    <%= form_with model: [@post, @message], html: {class: "form"}, local: true do |f| %>
      <div class="d-flex justify-content-end">
        <div class="col"  style="width: 100%">
          <%= f.text_area :text, calss:"form-control", size: "70×10" %>
        </div>

        <div class="col">
          <%= f.file_field :image %>
        </div>

        <div class="col">
          <%= f.submit "投稿", class: "mb-3 btn btn-primary btn-sm mr-5" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
</div>

